const M=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&e(l)}).observe(document,{childList:!0,subtree:!0});function i(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function e(s){if(s.ep)return;s.ep=!0;const r=i(s);fetch(s.href,r)}};M();class d{constructor(){this.subscribers=[]}on(t){this.subscribers.push(t)}off(t){this.subscribers=this.subscribers.filter(i=>i!==t)}emit(t){this.subscribers.forEach(i=>{i(t)})}}var a={changeTool:new d,changeColor:new d,changeSize:new d,changeCtrl:new d,changeModifier:new d};function f(o,t){const i=document.createElement("canvas");return i.width=t.offsetWidth,i.height=t.offsetHeight,i.id=o,i}class _{constructor(t){this.container=document.querySelector(t),this.canvas1=f("mainCanvas",this.container),this.canvas2=f("secondaryCanvas",this.container),this.container.append(this.canvas1),this.container.append(this.canvas2),this.ctx1=this.canvas1.getContext("2d"),this.ctx2=this.canvas2.getContext("2d"),this.mouse={x:0,y:0},this.currentTool=null,this.toolParams={color:"black",size:8,isCtrl:!1,modifier:null},this.bindEvents()}bindEvents(){document.addEventListener("mousemove",t=>{this.mouse.x=t.pageX,this.mouse.y=t.pageY,this.currentTool&&this.currentTool.onMouseMove(t.pageX,t.pageY,this.ctx1,this.ctx2,this.toolParams)}),this.canvas1.addEventListener("mousedown",t=>{this.currentTool&&this.currentTool.onMouseDown(t.offsetX,t.offsetY,this.ctx1,this.ctx2,this.toolParams)}),this.canvas1.addEventListener("mouseup",t=>{this.currentTool&&this.currentTool.onMouseUp(t.offsetX,t.offsetY,this.ctx1,this.ctx2,this.toolParams)})}setColor(t){this.toolParams.color=t,this.currentTool.onMouseMove(this.mouse.x,this.mouse.y,this.ctx1,this.ctx2,this.toolParams),a.changeColor.emit(t)}setSize(t){this.toolParams.size=t,this.currentTool.onMouseMove(this.mouse.x,this.mouse.y,this.ctx1,this.ctx2,this.toolParams),a.changeSize.emit(t)}setTool(t){this.currentTool=t,this.currentTool.onMouseMove(this.mouse.x,this.mouse.y,this.ctx1,this.ctx2,this.toolParams),a.changeTool.emit(t)}setModifier(t){this.toolParams.modifier=t,this.currentTool.onMouseMove(this.mouse.x,this.mouse.y,this.ctx1,this.ctx2,this.toolParams),a.changeModifier.emit(t)}}const n=new _("#canvasCnt");var c={tools:[{key:"`",tool:"eraser"},{key:"1",tool:"brush"},{key:"2",tool:"line"},{key:"3",tool:"rectangle"},{key:"4",tool:"circle"},{key:"5",tool:"triangle"},{key:"Escape",tool:"wiper"},{key:"F1",tool:"saver"}],modifiers:[{key:"Control",modifier:"control"},{key:"Shift",modifier:"shift"},{key:"Alt",modifier:"alt"}],colors:[{key:"r",color:"red"},{key:"g",color:"green"},{key:"b",color:"blue"}]};class k{constructor(){this.keyUpTool=this.keyUpTool.bind(this),this.keyUpColor=this.keyUpColor.bind(this),this.wheelSize=this.wheelSize.bind(this),this.keyUpTool=this.keyUpTool.bind(this),this.keyDownModifier=this.keyDownModifier.bind(this),this.keyUpModifier=this.keyUpModifier.bind(this),document.addEventListener("keyup",this.keyUpTool),document.addEventListener("keyup",this.keyUpColor),document.addEventListener("keydown",this.keyDownModifier),document.addEventListener("keyup",this.keyUpModifier),document.addEventListener("wheel",this.wheelSize)}keyUpTool(t){c.tools.forEach(i=>{if(t.key===i.key){const e=u(i.tool);t.key!=="Escape"&&t.key!=="F1"&&n.setTool(e)}})}keyUpColor(t){c.colors.forEach(i=>{if(t.key===i.key){const e=i.color;n.setColor(e)}})}keyDownModifier(t){c.modifiers.forEach(i=>{if(t.key===i.key){const e=i.modifier;n.setModifier(e)}})}keyUpModifier(t){c.modifiers.forEach(i=>{if(t.key===i.key){const e=null;n.setModifier(e)}})}wheelSize(t){let i=n.toolParams.size;t.deltaY>0&&(i=this.decreaseWidth(i)),t.deltaY<0&&(i=this.increaseWidth(i)),n.setSize(i)}ctrlUp(t){if(t.ctrlKey)return!0}decreaseWidth(t){return t-=2,Math.max(2,t)}increaseWidth(t){return t+=2,Math.min(60,t)}}new k;class h{constructor(){this.name=""}drawPointer(t,i,e,s,r){}onMouseMove(t,i,e,s,r){}onMouseUp(t,i,e,s,r){}onMouseDown(t,i,e,s,r){}}class b extends h{constructor(){super();this.name="brush",this._draw=!1,this._prevX=0,this._prevY=0}drawPointer(t,i,e,s){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.save(),e.lineWidth=2,e.lineCap="round",e.strokeStyle=s.color,e.globalAlpha=1,e.beginPath(),e.arc(t,i,s.size/2-1,0,2*Math.PI),e.stroke(),e.closePath(),e.restore()}onMouseMove(t,i,e,s,r){this._draw?(e.lineWidth=r.size,e.lineCap="round",e.strokeStyle=r.color,e.beginPath(),e.moveTo(this._prevX,this._prevY),e.lineTo(t,i),e.stroke()):this.drawPointer(t,i,s,r),this._prevX=t,this._prevY=i}onMouseUp(t,i,e,s,r){this._draw=!1,e.restore()}onMouseDown(t,i,e,s,r){this._draw||(this._draw=!0,e.save())}}class z extends h{constructor(){super();this.name="line",this._draw=!1,this._startX=0,this._startY=0}drawFigure(t,i,e,s){e.lineWidth=s.size,e.lineCap="square",e.strokeStyle=s.color,e.beginPath(),e.moveTo(this._startX,this._startY),e.lineTo(t,i),e.stroke(),e.closePath(),e.restore()}drawPointer(t,i,e,s){e.save(),e.lineWidth=2,e.lineCap="round",e.strokeStyle=s.color,e.globalAlpha=1,e.beginPath(),e.strokeRect(t-s.size/2,i-s.size/2,s.size,s.size),e.restore()}onMouseMove(t,i,e,s,r){s.clearRect(0,0,s.canvas.width,s.canvas.height),this._draw?this.drawFigure(t,i,s,r):this.drawPointer(t,i,s,r)}onMouseUp(t,i,e,s,r){this._draw&&this.drawFigure(t,i,e,r),this._draw=!1}onMouseDown(t,i,e,s,r){this._draw||(this._draw=!0,this._startX=t,this._startY=i)}}class A extends h{constructor(){super();this.name="rectangle",this._draw=!1,this._startX=0,this._startY=0}drawFigure(t,i,e,s){e.lineWidth=s.size,e.lineCap="round",e.beginPath(),s.modifier=="control"?(e.fillStyle=s.color,e.fillRect(this._startX,this._startY,t-this._startX,i-this._startY)):(e.strokeStyle=s.color,e.strokeRect(this._startX,this._startY,t-this._startX,i-this._startY)),e.restore()}drawPointer(t,i,e,s){e.save(),e.lineWidth=2,e.lineCap="round",e.strokeStyle=s.color,e.globalAlpha=1,e.beginPath(),e.strokeRect(t-s.size/2,i-s.size/2,s.size,s.size),e.restore()}onMouseMove(t,i,e,s,r){s.clearRect(0,0,s.canvas.width,s.canvas.height),this._draw?this.drawFigure(t,i,s,r):this.drawPointer(t,i,s,r)}onMouseUp(t,i,e,s,r){this._draw&&this.drawFigure(t,i,e,r),this._draw=!1}onMouseDown(t,i,e,s,r){this._draw||(this._draw=!0,this._startX=t,this._startY=i)}}class T extends h{constructor(){super();this.name="circle",this._draw=!1,this._startX=0,this._startY=0}drawFigure(t,i,e,s){e.save(),e.lineWidth=s.size,e.lineCap="round",e.beginPath();const r=Math.min(this._startX,t);let l=Math.min(this._startY,i),g=Math.max(this._startX,t),w=Math.max(this._startY,i),v=r+(g-r)/2,p=l+(w-l)/2,m=(g-r)/2,y=(w-l)/2;e.ellipse(v,p,m,y,0,0,2*Math.PI),s.modifier=="control"?(e.fillStyle=s.color,e.fill()):(e.strokeStyle=s.color,e.stroke()),e.restore()}drawPointer(t,i,e,s){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.save(),e.lineWidth=2,e.lineCap="round",e.strokeStyle=s.color,e.globalAlpha=1,e.beginPath(),e.arc(t,i,s.size/2-1,0,2*Math.PI),e.stroke(),e.closePath(),e.restore()}onMouseMove(t,i,e,s,r){s.clearRect(0,0,s.canvas.width,s.canvas.height),this._draw?this.drawFigure(t,i,s,r):this.drawPointer(t,i,s,r)}onMouseUp(t,i,e,s,r){this._draw&&this.drawFigure(t,i,e,r),this._draw=!1}onMouseDown(t,i,e,s,r){this._draw||(this._draw=!0,this._startX=t,this._startY=i)}}class Y extends h{constructor(){super();this.name="triangle",this._draw=!1,this._startX=0,this._startY=0}sideOfTriangle(t){return this._startX-(t-this._startX)}drawFigure(t,i,e,s){e.lineWidth=s.size,e.lineCap="round",e.beginPath(),e.moveTo(this._startX,this._startY),e.lineTo(t,i),e.lineTo(this.sideOfTriangle(t),i),e.closePath(),s.modifier=="control"?(e.fillStyle=s.color,e.fill()):(e.strokeStyle=s.color,e.stroke()),e.restore()}drawPointer(t,i,e,s){e.save(),e.lineWidth=2,e.lineCap="round",e.strokeStyle=s.color,e.globalAlpha=1,e.beginPath(),e.moveTo(t,i-s.size/2),e.lineTo(t-s.size/2+s.size,i-s.size/2+s.size),e.lineTo(t-s.size/2,i-s.size/2+s.size),e.closePath(),e.stroke(),e.restore()}onMouseMove(t,i,e,s,r){s.clearRect(0,0,s.canvas.width,s.canvas.height),this._draw?this.drawFigure(t,i,s,r):this.drawPointer(t,i,s,r)}onMouseUp(t,i,e,s,r){this._draw&&this.drawFigure(t,i,e,r),this._draw=!1}onMouseDown(t,i,e,s,r){this._draw||(this._draw=!0,this._startX=t,this._startY=i)}}class C extends h{constructor(){super();this.name="eraser",this._draw=!1,this._prevX=0,this._prevY=0}drawPointer(t,i,e,s){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.save(),e.lineWidth=2,e.lineCap="round",e.strokeStyle=s.color,e.globalAlpha=1,e.beginPath(),e.strokeRect(t-s.size/2,i-s.size/2,s.size,s.size),e.stroke(),e.closePath(),e.restore()}onMouseMove(t,i,e,s,r){this._draw?(this.drawPointer(t,i,s,r),e.globalCompositeOperation="destination-out",e.lineWidth=r.size,e.lineCap="round",e.strokeStyle="rgba(255,255,255,1)",e.beginPath(),e.moveTo(this._prevX,this._prevY),e.lineTo(t,i),e.stroke()):this.drawPointer(t,i,s,r),this._prevX=t,this._prevY=i}onMouseUp(t,i,e,s,r){this._draw=!1,e.restore()}onMouseDown(t,i,e,s,r){this._draw||(this._draw=!0,e.save())}}class S extends h{constructor(){super();this.name="wiper",this._draw=!1,this._prevX=0,this._prevY=0,n.ctx1.clearRect(0,0,n.ctx1.canvas.width,n.ctx1.canvas.height)}}class E extends h{constructor(){super();if(this.name="saver",this._draw=!1,this._prevX=0,this._prevY=0,this.imageName=prompt("Enter image name"),this.imageName!==null){const t=n.canvas1.toDataURL();this.a=document.createElement("a"),this.a.href=t,this.a.download=this.imageName||"drawing",this.a.click()}}}function u(o){switch(o){case"brush":return new b;case"line":return new z;case"rectangle":return new A;case"circle":return new T;case"triangle":return new Y;case"eraser":return new C;case"wiper":return new S;case"saver":return new E}}class W{constructor(t){this.cnt=null,this.generateHTML(t),this.bindEvents()}generateHTML(t){const i={eraser:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgba(0, 0, 0, 1);transform: ;msFilter:;"><path d="M12.48 3 7.73 7.75 3 12.59a2 2 0 0 0 0 2.82l4.3 4.3A1 1 0 0 0 8 20h12v-2h-7l7.22-7.22a2 2 0 0 0 0-2.83L15.31 3a2 2 0 0 0-2.83 0zM8.41 18l-4-4 4.75-4.84.74-.75 4.95 4.95-4.56 4.56-.07.08z"></path></svg>',wiper:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M7 4V2h10v2h5v2h-2v15a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V6H2V4h5zM6 6v14h12V6H6zm3 3h2v8H9V9zm4 0h2v8h-2V9z"/></svg>',brush:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M15.456 9.678l-.142-.142a5.475 5.475 0 0 0-2.39-1.349c-2.907-.778-5.699.869-6.492 3.83-.043.16-.066.34-.104.791-.154 1.87-.594 3.265-1.8 4.68 2.26.888 4.938 1.514 6.974 1.514a5.505 5.505 0 0 0 5.31-4.078 5.497 5.497 0 0 0-1.356-5.246zM13.29 6.216l4.939-3.841a1 1 0 0 1 1.32.082l2.995 2.994a1 1 0 0 1 .082 1.321l-3.84 4.938a7.505 7.505 0 0 1-7.283 9.292C8 21.002 3.5 19.5 1 18c3.98-3 3.047-4.81 3.5-6.5 1.058-3.95 4.842-6.257 8.789-5.284zm3.413 1.879c.065.063.13.128.193.194l1.135 1.134 2.475-3.182-1.746-1.746-3.182 2.475 1.125 1.125z"/></svg>',line:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M5 11H19V13H5z"/></svg>',rectangle:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M20,3H4C3.448,3,3,3.447,3,4v16c0,0.553,0.448,1,1,1h16c0.553,0,1-0.447,1-1V4C21,3.447,20.553,3,20,3z M19,19H5V5h14V19z"/></svg>',circle:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12,2C6.486,2,2,6.486,2,12s4.486,10,10,10s10-4.486,10-10S17.514,2,12,2z M12,20c-4.411,0-8-3.589-8-8s3.589-8,8-8 s8,3.589,8,8S16.411,20,12,20z"/></svg>',triangle:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: rgba(0, 0, 0, 1);transform: ;msFilter:;"><path d="M3 19h18a1.002 1.002 0 0 0 .823-1.569l-9-13c-.373-.539-1.271-.539-1.645 0l-9 13A.999.999 0 0 0 3 19zm9-12.243L19.092 17H4.908L12 6.757z"></path></svg>',saver:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" style="fill: rgba(0, 0, 0, 1);transform: ;msFilter:;"><path d="M5 21h14a2 2 0 0 0 2-2V8a1 1 0 0 0-.29-.71l-4-4A1 1 0 0 0 16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2zm10-2H9v-5h6zM13 7h-2V5h2zM5 5h2v4h8V5h.59L19 8.41V19h-2v-5a2 2 0 0 0-2-2H9a2 2 0 0 0-2 2v5H5z"></path></svg>'};this.cnt=document.createElement("div"),this.cnt.classList.add("gui"),this.cnt.innerHTML=`
            <div class="gui-color">
                <span class="gui-color__element"></span>
            </div>
            <ul class="gui-tools">
                ${c.tools.map(e=>`<li class="gui-tools__element" data-tool="${e.tool}">${i[e.tool]}</li>`).join("")}
            </ul>
        `,document.querySelector(t).append(this.cnt)}updateToolsList(t){t!=="wiper"&&t!=="saver"&&(this.cnt.querySelectorAll(".gui-tools__element").forEach(i=>{i.classList.remove("is-active")}),this.cnt.querySelector(`.gui-tools__element[data-tool="${t}"]`).classList.add("is-active"))}updateColor(t){this.cnt.querySelector(".gui-color__element").style.background=t}bindEvents(){this.cnt.querySelectorAll(".gui-tools__element").forEach(t=>{t.addEventListener("click",i=>{const e=u(t.dataset.tool);t.dataset.tool!=="wiper"&&t.dataset.tool!=="saver"&&n.setTool(e)})}),a.changeTool.on(t=>{this.updateToolsList(t.name)}),a.changeColor.on(t=>{this.updateColor(t)})}}new W("#app");class U{constructor(){this.test(),n.setTool(u("brush")),n.setColor("black"),n.setSize(8)}test(){a.changeTool.on(t=>{console.log("Tool changed for ",t)}),a.changeSize.on(t=>{console.log("Resized to ",t)}),a.changeColor.on(t=>{console.log("Color changed for ",t)}),a.changeModifier.on(t=>{console.log("Modifier changed for: ",t)}),a.changeCtrl.on(t=>{console.log("Ctrl: ",t)})}}new U;
//# sourceMappingURL=index.d7a4b4da.js.map
